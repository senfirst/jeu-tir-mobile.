<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jeu de Tir Arcade</title>
<style>
body { margin:0; overflow:hidden; background:black; font-family:Arial; color:white; }
canvas { display:block; margin:auto; background:#000814; }
#score { position:absolute; top:10px; left:10px; font-size:20px; }
#lives { position:absolute; top:10px; right:10px; font-size:20px; }
#level { position:absolute; top:40px; left:10px; font-size:20px; }
#mobile { position:fixed; bottom:10px; width:100%; display:flex; justify-content:center; z-index:100; }
.btn { width:60px; height:60px; border-radius:50%; background:#f1c40f; display:flex; justify-content:center; align-items:center; font-size:30px; margin:10px; user-select:none; }
</style>
</head>
<body>

<div id="score">Score : 0</div>
<div id="lives">‚ù§Ô∏è x3</div>
<div id="level">Niveau : 1</div>

<canvas id="game"></canvas>

<div id="mobile">
    <div class="btn" id="left">‚óÄ</div>
    <div class="btn" id="shoot">üî•</div>
    <div class="btn" id="right">‚ñ∂</div>
</div>

<audio id="music" src="music.mp3" loop></audio>
<audio id="shootSound" src="shoot.mp3"></audio>
<audio id="explosionSound" src="explosion.mp3"></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player = { x: canvas.width/2-25, y: canvas.height-80, w:50, h:50, speed:7 };
let bullets = [];
let enemies = [];
let score = 0;
let lives = 3;
let level = 1;
let boss = null;

const music = document.getElementById("music");
const shootSound = document.getElementById("shootSound");
const explosionSound = document.getElementById("explosionSound");
let musicPlaying = false;

/* Joueur */
function drawPlayer() {
    ctx.fillStyle = "cyan";
    ctx.fillRect(player.x, player.y, player.w, player.h);
}

/* Tirer */
function shoot() {
    bullets.push({ x: player.x+player.w/2-5, y: player.y, w:10, h:20, speed:10 });
    shootSound.currentTime=0;
    shootSound.play();
}

/* Balles */
function drawBullets() {
    ctx.fillStyle = "yellow";
    bullets.forEach((b,i)=>{
        b.y -= b.speed;
        ctx.fillRect(b.x,b.y,b.w,b.h);
        if(b.y<0) bullets.splice(i,1);
    });
}

/* Ennemis */
function spawnEnemy(){
    if(level <5 || boss) return; // Boss level apr√®s 5
    let w = 40, h = 40;
    enemies.push({ x: Math.random()*(canvas.width-w), y:-h, w, h, speed:2+Math.random()*level });
}
setInterval(spawnEnemy,1000);

function spawnBoss(){
    boss = { x: canvas.width/2 - 50, y: -100, w:100, h:100, speed:1, hp: 20+level*5 };
}

/* Dessiner ennemis et boss */
function drawEnemies(){
    ctx.fillStyle = "red";
    enemies.forEach((e,ei)=>{
        e.y += e.speed;
        ctx.fillRect(e.x,e.y,e.w,e.h);

        // Collision balle
        bullets.forEach((b,bi)=>{
            if(b.x < e.x+e.w && b.x+b.w > e.x && b.y < e.y+e.h && b.y+b.h > e.y){
                enemies.splice(ei,1);
                bullets.splice(bi,1);
                score++;
                document.getElementById("score").innerText = "Score : "+score;
                explosionSound.currentTime=0;
                explosionSound.play();
            }
        });

        // Collision joueur
        if(player.x < e.x+e.w && player.x+player.w > e.x && player.y < e.y+e.h && player.y+player.h > e.y){
            enemies.splice(ei,1);
            lives--;
            document.getElementById("lives").innerText = "‚ù§Ô∏è x"+lives;
            explosionSound.currentTime=0;
            explosionSound.play();
            if(lives<=0){
                alert("üíÄ Game Over ! Score : "+score);
                location.reload();
            }
        }

        if(e.y>canvas.height) enemies.splice(ei,1);
    });

    // Boss
    if(boss){
        boss.y += boss.speed;
        if(boss.y > 50) boss.speed=0;
        ctx.fillStyle="purple";
        ctx.fillRect(boss.x,boss.y,boss.w,boss.h);

        // collision balle
        bullets.forEach((b,bi)=>{
            if(b.x < boss.x+boss.w && b.x+b.w > boss.x && b.y < boss.y+boss.h && b.y+b.h > boss.y){
                bullets.splice(bi,1);
                boss.hp--;
                explosionSound.currentTime=0;
                explosionSound.play();
                if(boss.hp<=0){
                    boss=null;
                    level++;
                    document.getElementById("level").innerText="Niveau : "+level;
                }
            }
        });

        // collision joueur
        if(player.x < boss.x+boss.w && player.x+player.w > boss.x && player.y < boss.y+boss.h && player.y+player.h > boss.y){
            lives=0;
            document.getElementById("lives").innerText="‚ù§Ô∏è x0";
            alert("üíÄ Game Over ! Score : "+score);
            location.reload();
        }
    }
}

/* Clavier */
document.addEventListener("keydown", e=>{
    if(e.key==="ArrowLeft") player.x -= player.speed;
    if(e.key==="ArrowRight") player.x += player.speed;
    if(e.key===" ") shoot();
});

/* Mobile */
document.getElementById("left").addEventListener("touchstart", ()=>{ player.x -= player.speed*3; });
document.getElementById("right").addEventListener("touchstart", ()=>{ player.x += player.speed*3; });
document.getElementById("shoot").addEventListener("touchstart", shoot);

/* Musique */
function toggleMusic(){
    if(musicPlaying){ music.pause(); } else { music.play(); }
    musicPlaying=!musicPlaying;
}

/* Boucle du jeu */
function gameLoop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    drawPlayer();
    drawBullets();
    drawEnemies();
    if(level>=5 && !boss) spawnBoss();
    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
